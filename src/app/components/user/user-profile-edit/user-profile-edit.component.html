<div>
  <div class="user-profile-edit">
    <div class="profile-bg">
      <img src="https://images.limely.co.uk/wp-content/uploads/fashion-shopify-header-image-e1701774356161.jpg" alt="bg-placeholder" />
    </div>
    <div *ngIf="!loadingUserInfo" class="pt-5">
      <div class="card mx-md-auto mx-sm-3 mx-3 profile-card shadow bg-body rounded-none border-0" style="max-width: 900px">
        <app-user-profile-image [imageSrc]="imageSrc"></app-user-profile-image>
        <form [formGroup]="profileForm" class="row p-3 mx-auto" (submit)="saveProfile()">
          <div class="row mx-auto">
            <div class="col-12 col-md-6 mb-md-0 mb-3">
              <input
                type="text"
                placeholder="First Name"
                class="form-input w-100 w-md-50 shadow border-1"
                formControlName="firstName"
                [class]="{
                  error: profileForm.get('firstName')?.touched && !profileForm.get('firstName')?.valid
                }"
              />
              <span
                class="text-danger d-block text-hint"
                style="min-height: 20px"
                [class]="{
                  visible: profileForm.get('firstName')?.touched && !profileForm.get('firstName')?.valid,
                  invisible: !(profileForm.get('firstName')?.touched && !profileForm.get('firstName')?.valid)
                }"
              >
                <span *ngIf="profileForm.get('firstName')?.errors?.required">First name is required!</span>
                <span *ngIf="profileForm.get('firstName')?.errors?.minlength">First Name Name must be between 3 and 50 characters!</span>
                <span *ngIf="profileForm.get('firstName')?.errors?.maxlength">First Name Name must be between 3 and 50 characters!</span>
              </span>
            </div>
            <div class="col-12 col-md-6">
              <input
                type="text"
                placeholder="Last Name"
                class="form-input w-100 w-md-50 shadow"
                [class]="{
                  error: profileForm.get('lastName')?.touched && !profileForm.get('lastName')?.valid
                }"
                formControlName="lastName"
              />
              <span
                class="text-danger d-block text-hint"
                style="min-height: 20px"
                [class]="{
                  visible: profileForm.get('lastName')?.touched && !profileForm.get('lastName')?.valid,
                  invisible: !(profileForm.get('lastName')?.touched && !profileForm.get('lastName')?.valid)
                }"
              >
                <span *ngIf="profileForm.get('lastName')?.errors?.required">Last name is required!</span>
                <span *ngIf="profileForm.get('lastName')?.errors?.minlength">Last Name Name must be between 3 and 50 characters!</span>
                <span *ngIf="profileForm.get('lastName')?.errors?.maxlength">Last Name Name must be between 3 and 50 characters!</span>
              </span>
            </div>
          </div>
          <div class="row mt-3 mx-auto">
            <div class="col-12 col-md-6 mb-md-0 mb-3">
              <input type="text" placeholder="Email" class="form-input w-100 w-md-50 shadow border-1" formControlName="email" />
            </div>
            <div class="col-12 col-md-6">
              <input
                type="text"
                placeholder="Phone number"
                class="form-input w-100 w-md-50 shadow"
                [class]="{
                  error: profileForm.get('phoneNumber')?.touched && !profileForm.get('phoneNumber')?.valid
                }"
                formControlName="phoneNumber"
              />
              <span
                class="text-danger d-block text-hint"
                style="min-height: 20px"
                [class]="{
                  visible: profileForm.get('phoneNumber')?.touched && !profileForm.get('phoneNumber')?.valid,
                  invisible: !(profileForm.get('phoneNumber')?.touched && !profileForm.get('phoneNumber')?.valid)
                }"
              >
                <span *ngIf="profileForm.get('phoneNumber')?.errors?.required">Phone number is required!</span>
                <span *ngIf="profileForm.get('phoneNumber')?.errors?.pattern">Invalid phone number format!</span>
                <span *ngIf="profileForm.get('phoneNumber')?.errors?.minlength || profileForm.get('phoneNumber')?.errors?.maxlength">
                  Phone number should be within 3 ~ 100 characters!
                </span>
              </span>
            </div>
          </div>
          <div class="row mt-3 mx-auto">
            <div class="col-12">
              <textarea
                type="text"
                rows="5"
                placeholder="Enter your detailed address"
                class="form-input w-100 w-md-50 shadow border-1"
                [class]="{
                  error: profileForm.get('address')?.touched && !profileForm.get('address')?.valid
                }"
                formControlName="address"
              ></textarea>
              <span
                class="text-danger d-block text-hint"
                style="min-height: 20px"
                [class]="{
                  visible: profileForm.get('address')?.touched && !profileForm.get('address')?.valid,
                  invisible: !(profileForm.get('address')?.touched && !profileForm.get('address')?.valid)
                }"
              >
                <span *ngIf="profileForm.get('address')?.errors?.required">Address is required!</span>
                <span *ngIf="profileForm.get('address')?.errors?.minlength || profileForm.get('address')?.errors?.maxlength">
                  Address should be within 3 ~ 100 characters!
                </span>
              </span>
            </div>
          </div>
          <div class="mt-3 d-flex justify-content-center align-items-center gap-3">
            <button class="btn btn-success btn-sm px-3" type="submit" [disabled]="isSubmitting || !profileForm.valid">
              <span *ngIf="isSubmitting" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
              {{ isSubmitting ? 'Loading...' : 'Save' }}
            </button>
            <a class="btn btn-secondary btn-sm px-3" routerLink="/profile">Cancel</a>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
