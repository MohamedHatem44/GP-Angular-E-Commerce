<div>
  <div class="user-profile-edit">
    <div class="profile-bg">
      <img src="https://images.limely.co.uk/wp-content/uploads/fashion-shopify-header-image-e1701774356161.jpg" alt="bg-placeholder" />
    </div>
    <div class="pt-5">
      <div class="card mx-md-auto mx-sm-3 mx-3 profile-card shadow bg-body rounded-none border-0" style="max-width: 900px">
        <h4 class="px-3 py-1 section-heading my-4">Change Password</h4>
        <form [formGroup]="passwordForm" class="row p-3 mx-auto" (submit)="onSubmit()">
          <div class="row mx-auto">
            <div class="col-12 col-md-6 mb-md-0 mb-3">
              <div class="form-group r-icon">
                <button (click)="showOldPass = !showOldPass" type="button" class="icon-button">
                  <i class="fa-solid" [class]="showOldPass ? 'fa-eye' : 'fa-eye-slash'"></i>
                </button>
                <input
                  [type]="showOldPass ? 'text' : 'password'"
                  placeholder="Old Password"
                  class="form-input w-100 w-md-50 shadow border-1"
                  formControlName="oldPassword"
                  [class]="{
                    error: passwordForm.get('oldPassword')?.touched && !passwordForm.get('oldPassword')?.valid
                  }"
                />
              </div>
              <span
                class="text-danger d-block text-hint"
                style="min-height: 20px"
                [class]="{
                  visible: passwordForm.get('oldPassword')?.touched && !passwordForm.get('oldPassword')?.valid,
                  invisible: !(passwordForm.get('oldPassword')?.touched && !passwordForm.get('oldPassword')?.valid)
                }"
              >
                <span *ngIf="passwordForm.get('oldPassword')?.errors?.required">Old password is required!</span>
              </span>
            </div>
          </div>
          <div class="row mx-auto">
            <div class="col-12 col-md-6">
              <div class="form-group r-icon">
                <button (click)="showPassword = !showPassword" type="button" class="icon-button">
                  <i class="fa-solid" [class]="showPassword ? 'fa-eye' : 'fa-eye-slash'"></i>
                </button>
                <input
                  [type]="showPassword ? 'text' : 'password'"
                  placeholder="New Password"
                  class="form-input w-100 w-md-50 shadow"
                  [class]="{
                    error: passwordForm.get('password')?.touched && !passwordForm.get('password')?.valid
                  }"
                  formControlName="password"
                />
              </div>
              <span
                class="text-danger d-block text-hint"
                style="min-height: 20px"
                [class]="{
                  visible: passwordForm.get('password')?.touched && !passwordForm.get('password')?.valid,
                  invisible: !(passwordForm.get('password')?.touched && !passwordForm.get('password')?.valid)
                }"
              >
                <span *ngIf="passwordForm.get('password')?.errors?.required">New password is required!</span>
                <span *ngIf="passwordForm.get('password')?.errors?.minlength">Password must be between 8 and 50 characters!</span>
                <span *ngIf="passwordForm.get('password')?.errors?.maxlength">Password must be between 8 and 50 characters!</span>
              </span>
            </div>
            <div class="col-12 col-md-6">
              <div class="form-group r-icon">
                <button (click)="showConfirmPass = !showConfirmPass" type="button" class="icon-button">
                  <i class="fa-solid" [class]="showConfirmPass ? 'fa-eye' : 'fa-eye-slash'"></i>
                </button>
                <input
                  [type]="showConfirmPass ? 'text' : 'password'"
                  placeholder="Confirm New Password"
                  class="form-input w-100 w-md-50 shadow"
                  [class]="{
                    error: passwordForm.get('confirmPassword')?.touched && !passwordForm.get('confirmPassword')?.valid
                  }"
                  formControlName="confirmPassword"
                />
              </div>
              <span
                class="text-danger d-block text-hint"
                style="min-height: 20px"
                [class]="{
                  visible: passwordForm.get('confirmPassword')?.touched && !passwordForm.get('confirmPassword')?.valid,
                  invisible: !(passwordForm.get('confirmPassword')?.touched && !passwordForm.get('confirmPassword')?.valid)
                }"
              >
                <span *ngIf="passwordForm.get('confirmPassword')?.errors?.required">Confirming password is required!</span>
                <span *ngIf="passwordForm.get('confirmPassword')?.errors?.minlength">Password must be between 8 and 50 characters!</span>
                <span *ngIf="passwordForm.get('confirmPassword')?.errors?.maxlength">Password must be between 8 and 50 characters!</span>
              </span>
              <span class="text-danger d-block text-hint" *ngIf="passwordMismatch"> Both passwords are not matching! </span>
            </div>
          </div>
          <div class="mt-3 d-flex justify-content-center align-items-center gap-3">
            <button class="btn btn-success btn-sm px-3" type="submit" [disabled]="loading || !passwordForm.valid || passwordMismatch">
              <span *ngIf="loading" class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span>
              <span> {{ loading ? 'Loading...' : 'Save' }} </span>
            </button>
            <a class="btn btn-secondary btn-sm px-3" routerLink="/profile">Cancel</a>
          </div>
        </form>
      </div>
    </div>
  </div>
</div>
